/*@@@BUILDINFO@@@ Add Selected Layers To Selected Comps.jsx 1.0*//*// BEGIN__HARVEST_EXCEPTION_ZSTRING<javascriptresource><name>$$$/JavaScripts/LayersToComps/Menu=Add Selected Layers To Selected Comps</name><about>$$$/JavaScripts/LayersToComps/About=Add Selected Layers To Selected Comps.</about><category>sitegrinder</category><enableinfo>true</enableinfo></javascriptresource>// END__HARVEST_EXCEPTION_ZSTRING*//* Copyright 2012, Media Lab Inc.    Thi script is part of the amazing Photoshop to Website plugin "SiteGrinder 3"    http://www.medialab.com */main();function main() {        if ( app.documents.length <= 0 ) {        if ( DialogModes.NO != app.playbackDisplayDialogs ) {            alert( 'Script requires an open document' );        }    	return 'cancel';     }    try {	var doc = activeDocument;	groupSelectedLayers();	var selectedLayers = new Array();	var groupLayers = doc.activeLayer.layers;	var len = groupLayers.length;     if(len<=0) { executeAction(cTID('undo'), undefined, DialogModes.NO); alert('At least one layer must be selected'); return 'cancel'; }	for (var i = 0; i < len; i++) {		doc.activeLayer = groupLayers[i];		selectedLayers.push(doc.activeLayer);	}	executeAction(cTID('undo'), undefined, DialogModes.NO);		        var docName = app.activeDocument.name;        var compsName = new String("none");        var compsCount = app.activeDocument.layerComps.length;        if ( compsCount < 1 ) {              alert ( 'At least one layer comp must be selected'  ); 	    	return 'cancel';        } else {            app.activeDocument = app.documents[docName];            docRef = app.activeDocument;             for ( compsIndex = 0; compsIndex < compsCount; compsIndex++ ) {                var compRef = docRef.layerComps[ compsIndex ];                 if(compRef.selected) {					 compRef.apply();					 makeLayersVisible(selectedLayers);					 compRef.recapture();				}             }        }    }     catch (e) {        if ( DialogModes.NO != app.playbackDisplayDialogs ) {            alert(e);        }    	return 'cancel';     }}function makeLayersVisible(lays) {	var layCount = lays.length;	for ( var laysIndex= 0; laysIndex < layCount; laysIndex++ ) {		lays[laysIndex].visible=true;	}}function cTID(s) {return app.charIDToTypeID(s);}function sTID(s) {return app.stringIDToTypeID(s);}function groupSelectedLayers() {	var ref = new ActionReference();	ref.putClass(sTID('layerSection'));	var desc = new ActionDescriptor();	desc.putReference(cTID('null'), ref);	var ref2 = new ActionReference();	ref2.putEnumerated(cTID('Lyr '), cTID('Ordn'), cTID('Trgt'));	desc.putReference(cTID('From'), ref2);	executeAction(cTID('Mk  '), desc, DialogModes.NO);}